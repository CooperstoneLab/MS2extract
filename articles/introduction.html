<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MS2extract">
<title>Introduction to MS2extract package • MS2extract</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to MS2extract package">
<meta property="og:description" content="MS2extract">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MS2extract</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/batch_extract.html">Using MS2extract Batch Pipeline</a>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to MS2extract package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to MS2extract package</h1>
                        <h4 data-toc-skip class="author">Cristian
Quiroz-Moreno</h4>
            
            <h4 data-toc-skip class="date">2023-02-17</h4>
      
      
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette has the objective to introduce the
<strong>MS2extract</strong> package. The main goal of this package is to
provide a tool to create in-house MS2 compound libraries. Users can
access a specific function help through the command help(<em>[‘function
name’]</em>). It is worth to note that this package is aimed in the
targeted extraction of MS/MS scans and it is not able to perform
compound matching/annotation.</p>
<p>A simplified workflow is presented in Figure 1. Briefly, mzXML files
are imported in memory, then based on metadata provided by the user such
as compound chemical formula, the m/z is calculated extract the MS/MS
scans matching with the theoretical m/z. Then, low intensity signals, or
background noise, is removed out of the spectra. Finally, user can
export the extracted MS/MS spectra to a msp file format to be used as
reference library for further compound identification and
annotation.</p>
<div class="figure" style="text-align: center">
<img src="img/pipeline.png" alt="Figure 1. Overview of general data processing pipeline to extract MS/MS exptra using the MS2extract package" width="80%" height="80%"><p class="caption">
Figure 1. Overview of general data processing pipeline to extract MS/MS
exptra using the MS2extract package
</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>As previously mentioned, the workflow consist in four main steps:</p>
<ul>
<li>data import,</li>
<li>extract MS/MS scans,</li>
<li>detect mass, and</li>
<li>exporting MS/MS libraries</li>
</ul>
<p>In this section, we will explain in a more detail the main steps as
well as provide information about the required and optional arguments
that user may need to provide in order to properly use this package.</p>
<p>Additionally, this package also includes a set of
<code>batch_*()</code> functions that allows to process multiple mzxml
files at once. However, more metadata is required to run this automated
pipeline and the use of this <code>batch_*()</code> functions will be
described later in this document.</p>
<div class="section level3">
<h3 id="data-import">Data import<a class="anchor" aria-label="anchor" href="#data-import"></a>
</h3>
<p>This section is focused on describing how MS2extract package imports
MS/MS data.</p>
<p>The main import fuction relies on the newly implemented <a href="https://metid.tidymass.org" class="external-link">metID</a> R package. We adapted the
import function in order to read mass spectrometry data from mzXML
files. The new adaptation consists in importing scans data in a list (S3
object) rather than into a S4 object, facilitating the downstream tidy
analysis of this objects.</p>
<blockquote>
<p>This function execute a back-end calculation of theoretical ionized
mass of the compound in order to extract the precursor ions that match
that mass with a given ppm.</p>
</blockquote>
<p>The arguments of the <code><a href="../reference/import_mzxml.html">import_mzxml()</a></code> functions are
four:</p>
<ul>
<li>file</li>
<li>met_metadata</li>
<li>ppm</li>
<li>…</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cooperstonelab.github.io/MS2extract/">MS2extract</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Print function arg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/formals.html" class="external-link">formals</a></span><span class="op">(</span><span class="va">import_mzxml</span><span class="op">)</span></span>
<span><span class="co">#&gt; $file</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $met_metadata</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ppm</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $...</span></span></code></pre></div>
<div class="section level4">
<h4 id="file">File<a class="anchor" aria-label="anchor" href="#file"></a>
</h4>
<p>File consist in the file name of your mzXML file that contains MS/MS
data of your authentic standards or reference material. Here, we provide
an example file of Procyanidin A2 collected in Negative ionization mode
with a collision energy of 20 eV.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Importing the Spectrum of Procyanidin A2 in negative ionization mode</span></span>
<span><span class="co"># and 20 eV as the collision energy</span></span>
<span><span class="va">ProcA2_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                        <span class="st">"ProcyanidinA2_neg_20eV.mzXML"</span>,</span>
<span>                         package <span class="op">=</span> <span class="st">"MS2extract"</span><span class="op">)</span></span>
<span><span class="co"># File name</span></span>
<span><span class="va">ProcA2_file</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/MS2extract/extdata/ProcyanidinA2_neg_20eV.mzXML"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="met_metadata">met_metadata<a class="anchor" aria-label="anchor" href="#met_metadata"></a>
</h4>
<p>This argument refers to the metadata that user need to provide in
order to properly import scans that are related to the compound of
interest.</p>
<p>The <code>met_metadata</code> is a data frame that has required and
optional columns. The required columns are employed to calculate the
theoretical ionized m/z of a given formula and ionization mode. In the
optional columns, we have the option to provide the Region Of Interest
where the compound elutes in order to only keep this retention time
window.</p>
<p>The required columns are:</p>
<ul>
<li>
<strong>Formula:</strong> A character specifying the metabolite
formula</li>
<li>
<strong>Ionization_mode:</strong> The ionization mode employed in
data collection. It can be either <em>Positive</em> or
<em>Negative</em>
</li>
</ul>
<p>The optional columns are:</p>
<ul>
<li>
<strong>min_rt:</strong> a double with the minimum retention time to
keep</li>
<li>
<strong>max_rt:</strong> a double with the minimum retention time to
keep</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Procyanidin A2 metadata</span></span>
<span><span class="va">ProcA2_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Formula <span class="op">=</span> <span class="st">"C30H24O12"</span>,Ionization_mode <span class="op">=</span> <span class="st">"Negative"</span>,</span>
<span>                      min_rt <span class="op">=</span> <span class="fl">163</span>, max_rt <span class="op">=</span> <span class="fl">180</span><span class="op">)</span></span>
<span><span class="va">ProcA2_data</span></span>
<span><span class="co">#&gt;     Formula Ionization_mode min_rt max_rt</span></span>
<span><span class="co">#&gt; 1 C30H24O12        Negative    163    180</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ppm">ppm<a class="anchor" aria-label="anchor" href="#ppm"></a>
</h4>
<p>ppm refers to the maximum m/z deviation from the theoretical mass. By
default, 10 ppm are used.</p>
</div>
<div class="section level4">
<h4 id="import_mzxml">import_mzxml()<a class="anchor" aria-label="anchor" href="#import_mzxml"></a>
</h4>
<p>With all arguments explained, we can use the
<code><a href="../reference/import_mzxml.html">import_mzxml()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import Procyanidin A2 data</span></span>
<span><span class="va">ProcA2_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_mzxml.html">import_mzxml</a></span><span class="op">(</span><span class="va">ProcA2_file</span>, met_metadata <span class="op">=</span> <span class="va">ProcA2_data</span>, ppm <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Reading MS2 data from ProcyanidinA2_neg_20eV.mzXML</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Processing...</span></span></span>
<span></span>
<span><span class="co"># 24249 rows = ions detected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ProcA2_raw</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 24249     4</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="extracting-ms2-spectra">Extracting MS2 spectra<a class="anchor" aria-label="anchor" href="#extracting-ms2-spectra"></a>
</h3>
<p>Now that we have the data imported, we con proceed to extract the
<strong>most intense MS/MS scan</strong> between all scans.</p>
<p>This function computes the MS/MS TIC by summing up all intensities of
the MS/MS scans and select the scans with the highest intensities.</p>
<p>This function takes three arguments</p>
<ul>
<li>
<strong>spec:</strong> the imported MS/MS spectra</li>
<li>
<strong>verbose:</strong> a boolean, if verbose = TRUE, the MS/MS
TIC and spectra is printed, if verbose = FALSE, plots are not
displayed</li>
<li>
<strong>out_list:</strong> a boolean, if out_list = TRUE, the
extracted MS/MS spectra table and plots are returned as list, otherwise
only the MS/MS spectra is returned as data frame.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ProcA2_extracted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_MS2.html">extract_MS2</a></span><span class="op">(</span><span class="va">ProcA2_raw</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, out_list <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `position_stack()` requires non-overlapping <span style="color: #00BB00;">x</span> intervals</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-6-1.png" width="100%" height="100%"></p>
<p>Here, we can see in the top plot MS/MS tic that the scan colored in
red is the most intense and the MS/MS spectra of that scan will be
exported. At the bottom plot, we can see the Procyanidin A2 MS/MS
spectra at rt: 170.667. The maximum m/z axis value is &gt; 1500 m/z but
not significant ions are displayed. This can be explained due to low
intensities are kept in the MS/MS spectra.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ProcA2_extracted</span><span class="op">$</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  100.0852 1699.0981</span></span></code></pre></div>
<p>The range of the MS/MZ m/z value is from 100 m/z to 1699 m/z, but
intensities are too slow to be seen in the plot.</p>
</div>
<div class="section level3">
<h3 id="detecting-mass">Detecting mass<a class="anchor" aria-label="anchor" href="#detecting-mass"></a>
</h3>
<p>Similarly to the MZmine pipeline, detecting masses refers to set a
minimum signal intensity threshold that ions has to meet in order to be
kept. Thus, ion with lower intensities are removed from the data frame.
This function can also normalize the spectra ion intensity to percentage
based on the base peak.</p>
<p>The three required arguments are:</p>
<ul>
<li>
<strong>spec:</strong> a data frame containing the MS2 spectra.</li>
<li>
<strong>normalize:</strong> a boolean indicating if the MS2 spectra
is normalized by he base peak before proceeding to filter out low
intensity signal (normalize = TRUE), if normalize = FALSE the user has
to provide the minimum ion count.</li>
<li>
<strong>min_int</strong> an integer refereing to the minimum ion
intensity</li>
</ul>
<p>By default, the normalization is set to <code>TRUE</code> and the
minimum intensity is set to 1% to remove background noise.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ProcA2_detected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_mass.html">detect_mass</a></span><span class="op">(</span><span class="va">ProcA2_extracted</span>, normalize <span class="op">=</span> <span class="cn">TRUE</span>, min_int <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We can see now the range of m/z values and the maximium value is
576.1221 m/z.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">ProcA2_detected</span><span class="op">$</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 125.0243 576.1221</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="msms-spectra-plot">MS/MS spectra plot<a class="anchor" aria-label="anchor" href="#msms-spectra-plot"></a>
</h3>
<p>We can proceed to plot the clean MS/MS spectra with
<code><a href="../reference/plot_MS2spectra.html">plot_MS2spectra()</a></code> function. This is a ggplot2 based
function; the blue diamond refers to the precursor ion.</p>
<p>If we take a look to the previous MS/MS plot, there is less
background noise in this MS/MS spectra.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_MS2spectra.html">plot_MS2spectra</a></span><span class="op">(</span><span class="va">ProcA2_detected</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `position_stack()` requires non-overlapping <span style="color: #00BB00;">x</span> intervals</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="exporting-msms-spectra">Exporting MS/MS spectra<a class="anchor" aria-label="anchor" href="#exporting-msms-spectra"></a>
</h3>
<p>Finally after extracting the MS/MS spectra and removing background
noise, we can proceed to export the MS2 in a msp format.</p>
<p>For this task, we need extra information about the compound, such as
SMILES, COLLISIONENERGY, etc.</p>
<p>An example of this table can be found at:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reading the metadata</span></span>
<span><span class="va">metadata_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                             <span class="st">"msp_metadata.csv"</span>,</span>
<span>                             package <span class="op">=</span> <span class="st">"MS2extract"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">metadata_file</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ NAME            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Procyanidin A2"</span></span>
<span><span class="co">#&gt; $ PRECURSORTYPE   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "[M-H]-"</span></span>
<span><span class="co">#&gt; $ FORMULA         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "C30H24O12"</span></span>
<span><span class="co">#&gt; $ INCHIKEY        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NSEWTSAADLNHNH-LSBOWGMISA-N"</span></span>
<span><span class="co">#&gt; $ SMILES          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "C1C(C(OC2=C1C(=CC3=C2C4C(C(O3)(OC5=CC(=CC(=C45)O)O)C6…</span></span>
<span><span class="co">#&gt; $ IONMODE         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Negative"</span></span>
<span><span class="co">#&gt; $ INSTRUMENTTYPE  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Q-TOF 6545"</span></span>
<span><span class="co">#&gt; $ COLLISIONENERGY <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "20 eV"</span></span></code></pre></div>
<p>The precursor ion is not necessary to provide since this information
is included in the extracted MS/MS spectra.</p>
<p>The three arguments for this function are:</p>
<ul>
<li>
<strong>spec:</strong> a data frame containing the extracted MS2
spectra</li>
<li>
<strong>spec_metadata:</strong> a data frame containing the values
to be including in the resulting msp file</li>
<li>
<strong>msp_name:</strong> a string with the name of the msp file
not containing (.msp) extension</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_msp.html">write_msp</a></span><span class="op">(</span>spec <span class="op">=</span> <span class="va">ProcA2_detected</span>,</span>
<span>          spec_metadata <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>          msp_name <span class="op">=</span> <span class="st">"Procyanidin_A2"</span><span class="op">)</span></span></code></pre></div>
<p>After writing the msp file, you will see the following file
content:</p>
<pre><code><span><span class="co">#&gt; NAME: Procyanidin A2</span></span>
<span><span class="co">#&gt; PRECURSORMZ: 575.119567871094</span></span>
<span><span class="co">#&gt; PRECURSORTYPE: [M-H]-</span></span>
<span><span class="co">#&gt; FORMULA: C30H24O12</span></span>
<span><span class="co">#&gt; RETENTIONTIME: 170.667</span></span>
<span><span class="co">#&gt; IONMODE: Negative</span></span>
<span><span class="co">#&gt; COMMENT: Spectra extracted with MS2extract R package</span></span>
<span><span class="co">#&gt; INCHIKEY: NSEWTSAADLNHNH-LSBOWGMISA-N</span></span>
<span><span class="co">#&gt; SMILES: C1C(C(OC2=C1C(=CC3=C2C4C(C(O3)(OC5=CC(=CC(=C45)O)O)C6=CC(=C(C=C6)O)O)O)O)C7=CC(=C(C=C7)O)O)O</span></span>
<span><span class="co">#&gt; CCS: </span></span>
<span><span class="co">#&gt; COLLISIONENERGY: 20 eV</span></span>
<span><span class="co">#&gt; INSTRUMENTTYPE: Q-TOF 6545</span></span>
<span><span class="co">#&gt; Num Peaks: 38</span></span>
<span><span class="co">#&gt; 125.02431 10</span></span>
<span><span class="co">#&gt; 137.02441 3</span></span>
<span><span class="co">#&gt; 161.02449 2</span></span>
<span><span class="co">#&gt; 163.00355 3</span></span>
<span><span class="co">#&gt; 165.01881 2</span></span>
<span><span class="co">#&gt; 217.04996 2</span></span>
<span><span class="co">#&gt; 241.05002 2</span></span>
<span><span class="co">#&gt; 245.04547 2</span></span>
<span><span class="co">#&gt; 245.0817 2</span></span>
<span><span class="co">#&gt; 257.0451 2</span></span>
<span><span class="co">#&gt; 285.04063 62</span></span>
<span><span class="co">#&gt; 286.04387 4</span></span>
<span><span class="co">#&gt; 287.05579 7</span></span>
<span><span class="co">#&gt; 289.0718 48</span></span>
<span><span class="co">#&gt; 290.07495 3</span></span>
<span><span class="co">#&gt; 297.03993 4</span></span>
<span><span class="co">#&gt; 307.06114 2</span></span>
<span><span class="co">#&gt; 313.03573 2</span></span>
<span><span class="co">#&gt; 327.05044 7</span></span>
<span><span class="co">#&gt; 407.07693 16</span></span>
<span><span class="co">#&gt; 408.08161 2</span></span>
<span><span class="co">#&gt; 411.07227 9</span></span>
<span><span class="co">#&gt; 423.07231 53</span></span>
<span><span class="co">#&gt; 424.07537 5</span></span>
<span><span class="co">#&gt; 435.07138 3</span></span>
<span><span class="co">#&gt; 447.07296 5</span></span>
<span><span class="co">#&gt; 449.08799 51</span></span>
<span><span class="co">#&gt; 450.09044 6</span></span>
<span><span class="co">#&gt; 452.07453 15</span></span>
<span><span class="co">#&gt; 453.08155 7</span></span>
<span><span class="co">#&gt; 471.1086 2</span></span>
<span><span class="co">#&gt; 513.11796 2</span></span>
<span><span class="co">#&gt; 531.13006 2</span></span>
<span><span class="co">#&gt; 539.09834 22</span></span>
<span><span class="co">#&gt; 540.10156 3</span></span>
<span><span class="co">#&gt; 557.10809 5</span></span>
<span><span class="co">#&gt; 575.11968 100</span></span>
<span><span class="co">#&gt; 576.12208 13</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MS2extract_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] ProtGenerics_1.30.0   fs_1.6.1              doParallel_1.0.17    </span></span>
<span><span class="co">#&gt;  [4] rprojroot_2.0.3       MSnbase_2.24.2        tools_4.2.2          </span></span>
<span><span class="co">#&gt;  [7] backports_1.4.1       bslib_0.4.2           utf8_1.2.3           </span></span>
<span><span class="co">#&gt; [10] R6_2.5.1              affyio_1.68.0         BiocGenerics_0.44.0  </span></span>
<span><span class="co">#&gt; [13] colorspace_2.1-0      withr_2.5.0           tidyselect_1.2.0     </span></span>
<span><span class="co">#&gt; [16] compiler_4.2.2        preprocessCore_1.60.2 textshaping_0.3.6    </span></span>
<span><span class="co">#&gt; [19] cli_3.6.0             Biobase_2.58.0        desc_1.4.2           </span></span>
<span><span class="co">#&gt; [22] labeling_0.4.2        sass_0.4.5            scales_1.2.1         </span></span>
<span><span class="co">#&gt; [25] affy_1.76.0           pkgdown_2.0.7         systemfonts_1.0.4    </span></span>
<span><span class="co">#&gt; [28] stringr_1.5.0         digest_0.6.31         rmarkdown_2.20       </span></span>
<span><span class="co">#&gt; [31] pkgconfig_2.0.3       htmltools_0.5.4       OrgMassSpecR_0.5-3   </span></span>
<span><span class="co">#&gt; [34] fastmap_1.1.0         limma_3.54.1          highr_0.10           </span></span>
<span><span class="co">#&gt; [37] rlang_1.0.6           impute_1.72.3         farver_2.1.1         </span></span>
<span><span class="co">#&gt; [40] jquerylib_0.1.4       generics_0.1.3        jsonlite_1.8.4       </span></span>
<span><span class="co">#&gt; [43] mzID_1.36.0           BiocParallel_1.32.5   dplyr_1.1.0          </span></span>
<span><span class="co">#&gt; [46] car_3.1-1             magrittr_2.0.3        MALDIquant_1.22      </span></span>
<span><span class="co">#&gt; [49] Rcpp_1.0.10           munsell_0.5.0         S4Vectors_0.36.1     </span></span>
<span><span class="co">#&gt; [52] fansi_1.0.4           abind_1.4-5           MsCoreUtils_1.10.0   </span></span>
<span><span class="co">#&gt; [55] lifecycle_1.0.3       vsn_3.66.0            stringi_1.7.12       </span></span>
<span><span class="co">#&gt; [58] yaml_2.3.7            carData_3.0-5         MASS_7.3-58.1        </span></span>
<span><span class="co">#&gt; [61] zlibbioc_1.44.0       plyr_1.8.8            grid_4.2.2           </span></span>
<span><span class="co">#&gt; [64] parallel_4.2.2        ggrepel_0.9.3         crayon_1.5.2         </span></span>
<span><span class="co">#&gt; [67] lattice_0.20-45       cowplot_1.1.1         mzR_2.32.0           </span></span>
<span><span class="co">#&gt; [70] knitr_1.42            pillar_1.8.1          ggpubr_0.6.0         </span></span>
<span><span class="co">#&gt; [73] ggsignif_0.6.4        codetools_0.2-18      stats4_4.2.2         </span></span>
<span><span class="co">#&gt; [76] XML_3.99-0.13         glue_1.6.2            evaluate_0.20        </span></span>
<span><span class="co">#&gt; [79] Rdisop_1.58.0         pcaMethods_1.90.0     BiocManager_1.30.19  </span></span>
<span><span class="co">#&gt; [82] vctrs_0.5.2           foreach_1.5.2         gtable_0.3.1         </span></span>
<span><span class="co">#&gt; [85] purrr_1.0.1           tidyr_1.3.0           clue_0.3-64          </span></span>
<span><span class="co">#&gt; [88] cachem_1.0.6          ggplot2_3.4.1         xfun_0.37            </span></span>
<span><span class="co">#&gt; [91] broom_1.0.3           rstatix_0.7.2         ragg_1.2.5           </span></span>
<span><span class="co">#&gt; [94] ncdf4_1.21            tibble_3.1.8          iterators_1.0.14     </span></span>
<span><span class="co">#&gt; [97] memoise_2.0.1         IRanges_2.32.0        cluster_2.1.4</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Cristian Quiroz-Moreno.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
